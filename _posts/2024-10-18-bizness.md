---
title: Bizness
Date: 2024-10-18
categories: HackTheBox Easy
tags:
  - HTB
  - Bizness
image: '{"path":"/assets/htb/Screenshot 2024-10-18 at 10.37.08"}'
---
# MÃ´ táº£
Váº«n nhÆ° má»¥c tiÃªu Ä‘áº·t ra `má»—i tuáº§n má»™t bÃ i HTB` nÃªn hÃ´m nay, trÃ¹ng há»£p lÃ  láº¡i vÃ o chiá»u t6 rÃ£nh rá»—i, mÃ¬nh sáº½ giáº£i má»™t bÃ i HTB má»©c easy nÃ y.
Äá»c nháº¹ qua machine má»™t xÃ­ thÃ¬ cÃ³ váº» cÅ©ng khÃ¡ Ä‘Æ¡n giáº£n.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 15.31.13.png)

# Attack
## Recon
### *nmap*
![Screenshot](/assets/htb/Screenshot 2024-10-18 at 15.22.16.png)

Khai bÃ¡o domain `bizness.htb` vÃ o file hosts vÃ  truy cáº­p web tá»« trÃ¬nh duyá»‡t xem cÃ³ gÃ¬ hÃºp Ä‘Æ°á»£c hay khÃ´ng.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 15.33.39.png)

ÄÃ¢y cÃ³ váº» nhÆ° lÃ  má»™t site quáº£ng bÃ¡ cho má»™t doanh nghiá»‡p nÃ o Ä‘Ã³.
Xem thá»­ nÃ³ Ä‘ang dÃ¹ng nhá»¯ng cÃ´ng nghá»‡ nÃ o ?

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 15.34.47.png)

NÃ³ Ä‘ang cháº¡y `Java` vá»›i dá»‹ch vá»¥ web lÃ  `Nginx`.
Chá»£t nhá»› Ä‘áº¿n pháº§n mÃ´ táº£ vá» machine á»Ÿ Ä‘áº§u bÃ i viáº¿t nÃ y. NÃ³ cÃ³ nháº¯c Ä‘áº¿n CVE-2023-49070. Search vÃ  tÃ¬m hiá»ƒu vá» CVE nÃ y xem cÃ³ gÃ¬ vui.
NÃ´m na Ä‘Ã¢y lÃ  má»™t lá»— há»•ng unauthentication to RCE trong Apache Ofbiz trÆ°á»›c version 18.12.09.
## Exploit
POC cÅ©ng Ä‘Ã£ cÃ³ sáºµn á»Ÿ [github](https://github.com/Praison001/Apache-OFBiz-Auth-Bypass-and-RCE-Exploit-CVE-2023-49070-CVE-2023-51467) sau quÃ¡ trÃ¬nh search google cá»§a mÃ¬nh.
Tuy nhiÃªn, ban Ä‘áº§u mÃ¬nh há»›n ha há»›n há»Ÿ clone git vá» vÃ  exploit nhÆ°ng khÃ´ng thÃ nh cÃ´ng ğŸ˜¥ğŸ˜¥ğŸ˜¥ (hÃ¬nh dÆ°á»›i nÃ³ bÃ¡o váº­y thÃ´i chá»© `netcat` cá»§a mÃ¬nh váº«n chÆ°a báº¯t Ä‘Æ°á»£c connect).

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 16.04.02.png)

KhÃ´ng hiá»ƒu lÃ½ do táº¡i sao, nÃªn chui vÃ o file `exploit.py` Ä‘á»c xem ntn (idea cá»§a mÃ¬nh lÃºc áº¥y lÃ  tÃ­nh attack manual vÃ¬ khÃ´ng pháº£i lÃºc nÃ o POC sáºµn cÅ©ng cháº¡y Ä‘Æ°á»£c).
á»œ thÃ¬ nÃ´m na nÃ³ dÃ¹ng endpoint `/webtools/control/ping;/?USERNAME=&PASSWORD=&requirePasswordChange=Y` Ä‘á»ƒ scan xem website cÃ³ tá»“n táº¡i lá»— há»•ng hay khÃ´ng. Sau Ä‘Ã³ nÃ³ sá»­ dá»¥ng `ysoserial` Ä‘á»ƒ táº¡o payload rá»“i parse ná»™i dung ra dáº¡ng `xml` vÃ  Ä‘áº©y lÃªn theo Ä‘Æ°á»ng `xmlrpc`.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 16.00.16.png)

LÃ½ do mÃ¬nh exploit khÃ´ng thÃ nh cÃ´ng lÃ  vÃ¬ mÃ¬nh Ä‘ang sá»­ dá»¥ng version java 21.0.1 mÃ  tÆ°Æ¡ng á»©ng vá»›i lá»‡nh java trong code thÃ¬ pháº£i lÃ  version Java 8. Äá»‘i vá»›i cÃ¡c version Java 9 trá»Ÿ Ä‘i thÃ¬ mÃ¬nh pháº£i tá»± add thÃªm cÃ¡c module thÃ´ng qua option. VÃ¬ váº­y nÃªn mÃ¬nh Ä‘Ã£ thÃªm vÃ o cÃ¡c option cho command java trong code:
```
--add-opens java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED --add-opens java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED
```
![Screenshot](/assets/htb/Screenshot 2024-10-18 at 16.11.18.png)
BÃ¢y giá» cháº¡y láº¡i vÃ  láº¥y shell thÃ´i.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 16.12.24.png)

Yeah ğŸ¤ŸğŸ»ğŸ¤ŸğŸ»ğŸ¤ŸğŸ» ngon lÃ nh.
Flag 1 trong táº§m tay.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 16.14.10.png)
## Privilege Escalation
May thay vá»«a get RCE xong mÃ¬nh Ä‘á»©ng ngay path cá»§a `ofbiz` luÃ´n.

![Screenshot](/assets/htb/Screenshot 2024-10-18 at 17.45.37.png)

Lá»¥c lá»i kháº¯p path xem cÃ³ gÃ¬ hot hay khum nhÃ©.
Source cÅ©ng nhiá»u thá»© qÃ¡, mÃ¬nh má»›i Ä‘i Ä‘Æ°á»£c nhá»¯ng cÃ¡i tÃªn cáº£m tháº¥y kháº£ nghi nhÆ°ng chÆ°a tháº¥y gÃ¬ hot ngoÃ i máº¥y cÃ¡i user:pass file `README.adoc` nhÆ°ng Ä‘Ã³ cÅ©ng lÃ  nhá»¯ng account default. CÃ³ acc `admin:ofbiz` cÅ©ng lÃ  acc default vÃ  mÃ¬nh thá»­ login theo Ä‘Æ°á»ng dáº«n admin `https://bizness.htb/webtools/control/login` nhÆ°ng khÃ´ng thÃ nh cÃ´ng. ThÃ´i Ä‘á»ƒ cháº¡y vá» nhÃ  rá»“i máº§n tiáº¿p sau .........