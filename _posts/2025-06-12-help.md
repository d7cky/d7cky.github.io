---
title: Help
Date: 2025-12-06
categories: HackTheBox Easy
tags:
  - HTB
  - Easy
  - Blocky
  - OSWE
---
# MÃ´ táº£
Tiáº¿p tá»¥c vá»›i chuá»—i luyá»‡n táº­p OSWE mÃ¬nh sáº½ Ä‘áº¿n vá»›i bÃ i easy tiáº¿p theo.

![Screenshot](/assets/htb/Screenshot 2025-06-12 at 14.18.57.png)
# Attack
## Recon
`nmap`.

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.37.05.png)
## GraphQL Attack
ÄÃ£ cÃ³ port web rá»“i mÃ  cÃ²n thÃªm port 3000 cháº¡y NodeJs Ä‘á»ƒ lÃ m gÃ¬ nhá»‰ ? ThÆ°á»ng sáº½ lÃ  port vÃ o trang quáº£n trá»‹ hoáº·c lÃ  port cho API. Focus thá»­ vÃ o port nÃ y xem sao.

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.42.31.png)

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.43.04.png)

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.43.28.png)

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.43.46.png)

Sau khi fuzz thá»­ thÃ¬ chá»‰ cÃ³ má»—i endpoint `/graphql` bÃ¡o thiáº¿u tham sá»‘ query â˜ Kháº£ nÄƒng cao port nÃ y nÃ³ Ä‘ang dÃ¹ng graphQL.
Thá»­ Ã¡p dá»¥ng máº¥y payload lá»¥m láº·t á»Ÿ trÃªn máº¡ng xem cÃ³ hiá»‡u quáº£ hay khÃ´ng. 
`query={__schema{types{name,fields{name}}}}`

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 14.46.27.png)

Ngon nhá»ƒ ğŸ˜Œ
NhÆ° káº¿t quáº£ trÃªn mÃ¬nh hiá»ƒu nÃ´m na lÃ  trong báº£ng `User` cÃ³ `username` vÃ  `password`. Thá»­ láº¥y thÃ´ng tin cá»§a `username` vÃ  `password` xem sao.
CÃ¡ch láº¥y thÃ¬ chá»‰ cáº§n query tá»›i báº£ng `User` nhÆ° payload sau: 
`query={user{username, password}}`

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.03.56.png)

Lá»¥m káº¹o ğŸ˜…. CÆ¡ mÃ  pass nÃ y lÃ  pass Ä‘Ã£ md5 máº¥t rá»“i. DÃ¹ng `hashcat` crack nÃ³ thÃ´i ğŸ˜š

## Hashcat
![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.09.23.png)

Yeah password Ä‘Æ°á»£c tÃ¬m tháº¥y lÃ  `godhelpmeplz`
Truy cáº­p vÃ o port 80 vÃ  dÃ¹ng tÃ i khoáº£n vá»«a tÃ¬m Ä‘Æ°á»£c login vÃ o website.

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.33.18.png)

Æ  kÃ¬a ğŸ˜³. NÃ y lÃ  page webservice cÆ¡ mÃ . `feroxbuster` Ä‘i fuzz directory thÃ´i.

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.35.38.png)

Ã€ hÃ¡ nÃ³ náº±m á»Ÿ `/support`
## Exploit HelpDeskZ 
![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.36.47.png)

á»’ ğŸ˜². DÃ¹ng framework HelpDeskZ cÆ¡ Ã . TÃ¬m hiá»ƒu má»™t sá»‘ thÃ´ng tin vá» framework nÃ y thÃ¬ lÃ²i ra Ä‘Æ°á»£c cÃ¡i [git cá»§a nÃ³](https://github.com/helpdesk-z/helpdeskz-dev?tab=readme-ov-file).
NhÆ° thÃ´ng tin trÃªn git thÃ¬ Ä‘i vÃ o `README.md` lÃ  sáº½ tháº¥y Ä‘Æ°á»£c thÃ´ng tin version.

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.40.27.png)
### SQLi Attack
Hmmm ğŸ¤”. Ver nÃ y khÃ¡ cÅ© rá»“i â  kháº£ nÄƒng cao sáº½ cÃ³ CVE nÃ o Ä‘Ã³ lÃªn shell Ä‘Æ°á»£c.
`CVE-2020-26546` Ä‘Ã¢y rá»“i.
CÆ¡ mÃ  xu thÃ­a nhá»Ÿ, search lÃ²ng vÃ²ng mÃ  k tÃ¬m Ä‘Æ°á»£c POC sáºµn Ä‘á»ƒ cháº¡y ğŸ˜¢, Ä‘Ãºng lÃ  pháº£i cÃ³ lÃ m thÃ¬ má»›i cÃ³ Äƒn, k lÃ m mÃ  Ä‘Ã²i Äƒn thÃ¬ Äƒn má»©t Äƒn Ä‘áº§u bÃ² ğŸ¥¹ (bÃ i há»c tá»« tháº§y Huáº¥n).
ThÃ´i Ä‘Ã nh tá»± POC váº­y. 

![Screenshot](/assets/htb/Screenshot 2025-06-13 at 15.48.39.png)

Äá»c mÃ´ táº£ CVE thÃ¬ bug náº±m á»Ÿ pháº§n `rememberme` khi login.
Loay hoay mÃ£i váº«n chÆ°a khai thÃ¡c Ä‘Æ°á»£c SQLi chá»— tham sá»‘ `remember` nÃ³i trÃªn â‡¶ nÃ³ lÃ  open source cÆ¡ mÃ , lÃªn Ä‘á»c [source](https://github.com/ViktorNova/HelpDeskZ) nÃ³ xem luÃ´n cho nhanh ğŸ˜„

![Screenshot](/assets/htb/Screenshot 2025-06-16 at 11.06.20.png)

Äá»c code chá»— login xong tháº¥y tham sá»‘ `remember` Ä‘Ã¢u liÃªn quan gÃ¬ Ä‘áº¿n SQLi Ä‘Ã¢u nhá»‰ ? ğŸ¤” há»•ng láº½ CVE lá»«a mÃ¬nh ğŸ¤¨
May thay ngá»“i lá»¥c lá»i cÃ¡i code 1 há»“i thÃ¬ phÃ¡t hiá»‡n ra SQLi (blind) chá»— view file Ä‘Ã£ upload trong pháº§n ticket.
â†’ **PhÃ¢n tÃ­ch má»™t chÃºt cho dá»… hiá»ƒu ğŸ˜…**
```
$attachment = $db->fetchRow("SELECT *, COUNT(id) AS total FROM ".TABLE_PREFIX."attachments WHERE id=".$db->real_escape_string($params[2])." AND ticket_id=".$params[0]." AND msg_id=".$params[3]);
```
ÄÃ¢y lÃ  cÃ¢u query á»Ÿ `line 94` trong file `view_tickets_controller.php`. NhÃ¬n vÃ o cÃ¢u query trÃªn cÃ³ thá»ƒ nháº­n ra Ä‘Æ°á»£c ráº±ng 2 tham sá»‘ `$params[0]` vÃ  `$params[3]` chÆ°a Ä‘Æ°á»£c kiá»ƒm tra Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘em Ä‘i truy váº¥n. Tuy nhiÃªn náº¿u Ä‘á»c ká»¹ hÆ¡n thÃ¬ `$params[0]` á»Ÿ `line 17` trÆ°á»›c Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c kiá»ƒm tra Ä‘iá»u kiá»‡n pháº£i lÃ  kÃ½ tá»± sá»‘ má»›i Ä‘Æ°á»£c phÃ©p Ä‘i tiáº¿p âª lá»— há»•ng sáº½ Ä‘Æ°á»£c khai thÃ¡c thÃ´ng qua `$params[3]`.
âŸ¹ Váº­y thÃ¬ mÃ¬nh sáº½ tÃ¬m tá»›i Ä‘Ãºng endpoint Ä‘Ã³ vÃ  khai thÃ¡c thÃ´i. Bá»Ÿi vÃ¬ nÃ³ lÃ  blind nÃªn mÃ¬nh pháº£i tÃ¬m pháº£n há»“i Ä‘Ãºng, sai cá»§a cá»§a server Ä‘á»ƒ bruteforce thÃ´ng tin tá»« DB.

_**TrÆ°á»ng há»£p Ä‘Ãºng**_

![Screenshot](/assets/htb/Screenshot 2025-06-16 at 11.35.01.png)

_**TrÆ°á»ng há»£p sai**_

![Screenshot](/assets/htb/Screenshot 2025-06-16 at 11.35.51.png)

Dá»±a vÃ o Ä‘Ã¢y lÃ  biáº¿t cháº¯c cháº¯n cÃ³ SQLi rá»“i. DÃ¹ng SQLMap láº¥y data thÃ´i ğŸ˜‰

![Screenshot](/assets/htb/Screenshot 2025-06-17 at 17.33.35.png)

Ã€ hÃ¡ cÃ³ 5 database. MÃ  áº¯t háº³n mÃ¬nh chá»‰ quan tÃ¢m Ä‘áº¿n database `support` thÃ´i.

![Screenshot](/assets/htb/Screenshot 2025-06-17 at 17.36.56.png)

Yeah váº­y lÃ  cÃ³ 19 table nÃ y trong database `support`. CÆ¡ mÃ  table `users` vÃ  `staff` cÃ³ váº» lÃ m cho mÃ¬nh há»©ng thÃº nháº¥t.

![Screenshot](/assets/htb/Screenshot 2025-06-17 at 17.42.43.png)

![Screenshot](/assets/htb/Screenshot 2025-06-17 at 17.50.02.png)

Ã€ hÃ¡ váº­y thÃ¬ table `staff` Ä‘Ã£ cho mÃ¬nh biáº¿t Ä‘Æ°á»£c account `admin/Welcome1`. Loay hoay 1 há»“i má»›i tÃ¬m Ä‘Æ°á»£c cÃ¡i [page login](http://help.htb/support/?v=staff) cá»§a nÃ³.

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 10.40.06.png)

Äi 1 vÃ²ng trang admin cÅ©ng k tÃ¬m Ä‘Æ°á»£c cÃ¡i gÃ¬ hot Ä‘á»ƒ lÃªn shell. Chá»£t nhá»› ra ban Ä‘áº§u scan `nmap` váº«n cÃ²n dÆ° cÃ¡i port ssh chÆ°a dÃ¹ng Ä‘áº¿n Ä‘á»ƒ mÃ¬nh thá»­ nÃ³ vá»›i tk admin xem cÃ³ Ä‘Æ°á»£c khÃ´ng (máº¥y bÃ i lab HTB nÃ³ hay cÃ³ kiá»ƒu dÃ¹ng chung password nhÆ° dá»‹ hihi).
## SSH
![Screenshot](/assets/htb/Screenshot 2025-06-18 at 10.42.58.png)

Linh tÃ­nh mÃ¡ch báº£o tháº­t khÃ´ng sai kkkk. Ban Ä‘áº§u dÃ¹ng username `admin` khÃ´ng Ä‘Æ°á»£c, chuyá»ƒn qua username `help` thÃ¬ Ä‘Æ°á»£c, lÃ½ do mÃ¬nh biáº¿t username lÃ  `help` lÃ  bá»Ÿi vÃ¬ mÃ¬nh dá»±a vÃ o tÃªn bÃ i lab thÃ´i ğŸ¤£
Lá»¥m flag thÃ´i nÃ o ğŸ˜‰

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 10.45.57.png)
## Privilege Escalation
NhÆ° má»™t thÃ³i quen leo root mÃ¬nh sáº½ `sudo -l` trÆ°á»›c ğŸ˜….

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 10.56.15.png)

CÆ¡ mÃ  thÃ³i quen nÃ y khÃ´ng giÃºp Ä‘Æ°á»£c gÃ¬ trong trÆ°á»ng há»£p nÃ y rá»“i ğŸ¤£. ThÃ³i quen thá»© high lÃ  Ä‘i tÃ¬m CVE thÃ´ng qua version há»‡ thá»‘ng. `uname -a` thá»­ xem server nÃ y Ä‘ang dÃ¹ng báº£n cÅ© hay má»›i.

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 10.58.12.png)

Wow, cÅ©ng khÃ¡ lÃ  cÅ© rá»“i, google CVE cháº¯c sáº½ cÃ³ Ä‘Ã¢u Ä‘Ã³!!!
Google phÃ¡t ra thiá»‡t ğŸ¤ª. [CVE-2017-16995](https://github.com/Al1ex/CVE-2017-16995) cÃ³ sáºµn POC luÃ´n. Cá»© tháº¿ mÃ  cháº¡y thÃ´i quÃ¡ khoáº» ğŸ˜œ

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 11.04.03.png)

QuÃ¡ Ä‘Ã£ ğŸ˜š, lá»¥m flag tiáº¿p theo thÃ´i ğŸ˜‹

![Screenshot](/assets/htb/Screenshot 2025-06-18 at 11.05.16.png)
# Káº¿t luáº­n
## Flag 1
`b99e0422285d215869dbfc4f0707f91d`
## Flag 2
`4d33db5f8c7e3a5442eee1f5daaf4341`